name: ğŸ”™ Manual Rollback

on:
  workflow_dispatch:
    inputs:
      service:
        description: 'ë¡¤ë°±í•  ì„œë¹„ìŠ¤ (all ì„ íƒ ê¶Œì¥)'
        required: true
        type: choice
        options:
          - all
          - be
          - fe
          - ai
      environment:
        description: 'ëŒ€ìƒ í™˜ê²½'
        required: true
        default: 'develop'
        type: choice
        options:
          - develop
          - prod

jobs:
  rollback:
    runs-on: ubuntu-latest
    steps:
      - name: Execute Rollback
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ inputs.environment == 'prod' && secrets.EC2_HOST || secrets.DEV_EC2_HOST }}
          username: ${{ secrets.EC2_USERNAME }}
          key: ${{ secrets.EC2_SSH_KEY }}
          script: |
            # ë¡¤ë°± ëª…ë ¹ ì‹¤í–‰ (rollback ì¸ì ì „ë‹¬)
            bash /home/ubuntu/app/deploy.sh ${{ inputs.service }} ${{ inputs.environment }} rollback